// // @ts-ignore-error
// import * as Hawk from 'hawk';
// import { SagaIterator } from 'redux-saga';
// import { call, select } from 'redux-saga/effects';

// import { getJwt } from '@instore/redux/authentication/selectors';
// import { edgeGatewayLoyaltyEnabled } from '@instore/redux/features/selectors';
// import { autoBind } from '@instore/utils/autoBind';

// import { buildHawkOptions } from '../hawkAuthOptions';
// import { HeaderProviderType } from '../makeApiRequest/types';
// import { ApiRequestContext, HawkAuthenticationOptions, HeaderProvider } from '../types';

// export class LoyaltyHeaderProvider implements HeaderProvider {
//     constructor() {
//         autoBind(this);
//     }

//     *provide(context: ApiRequestContext): SagaIterator<object> {
//         const useEdge: boolean = yield select(edgeGatewayLoyaltyEnabled);

//         if (useEdge) {
//             return yield call(buildJwtHeader);
//         }

//         return yield call(buildHawkHeader, context);
//     }
//     getType(): HeaderProviderType {
//         return HeaderProviderType.LOYALTY;
//     }
// }

// /**
//  * Exported so that authentication related endpoints can opt-out of potentially hitting edge
//  */
// export class LoyaltyOnlyHeaderProvider implements HeaderProvider {
//     *provide(context: ApiRequestContext): SagaIterator<object> {
//         return yield call(buildHawkHeader, context);
//     }
//     getType(): HeaderProviderType {
//         return HeaderProviderType.LOYALTY_ONLY;
//     }
// }

// interface AuthHeader {
//     Authorization: string;
// }

// function* buildJwtHeader(): SagaIterator<AuthHeader> {
//     const jwt: string | null = yield select(getJwt);
//     return {
//         Authorization: `Bearer ${jwt}`
//     };
// }

// function* buildHawkHeader({ payload, method, url }: ApiRequestContext): SagaIterator<AuthHeader> {
//     const hawkOptions: HawkAuthenticationOptions = yield call(buildHawkOptions, method, payload);
//     return { Authorization: Hawk.client.header(url, method, hawkOptions).header };
// }
